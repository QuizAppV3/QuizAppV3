<!doctype html>
<html lang="fr">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>QuizAppV3 ‚Äî D√©veloppement informatique</title>
  <style>
    :root{--bg:#0f1724;--card:#0b1330;--accent:#6ee7b7;--muted:#94a3b8}
    *{box-sizing:border-box}
    body{margin:0;font-family:Inter,ui-sans-serif,system-ui,-apple-system,'Segoe UI',Roboto,'Helvetica Neue',Arial;color:#e6eef8;background:linear-gradient(180deg,#071028 0%,#071426 60%);min-height:100vh;display:flex;align-items:center;justify-content:center;padding:24px}
    .wrap{width:100%;max-width:900px}
    header{display:flex;align-items:center;gap:14px;margin-bottom:18px}
    .logo{width:64px;height:64px;border-radius:12px;background:linear-gradient(135deg,var(--accent),#60a5fa);display:flex;align-items:center;justify-content:center;color:#012;a font-weight:800;box-shadow:0 6px 30px rgba(0,0,0,.5)}
    h1{margin:0;font-size:20px}
    p.lead{margin:0;color:var(--muted);font-size:13px}

    .card{background:linear-gradient(180deg,rgba(255,255,255,.02),rgba(255,255,255,.01));padding:22px;border-radius:14px;box-shadow:0 10px 40px rgba(2,6,23,.6);border:1px solid rgba(255,255,255,.03)}

    .question-meta{display:flex;justify-content:space-between;align-items:center;margin-bottom:10px}
    .progress{height:10px;background:rgba(255,255,255,.03);border-radius:999px;overflow:hidden;flex:1;margin-left:12px}
    .progress > i{display:block;height:100%;background:linear-gradient(90deg,var(--accent),#60a5fa);width:0%}

    .q{font-size:18px;margin:14px 0}
    .options{display:grid;gap:10px}
    .option{background:rgba(255,255,255,.02);padding:12px;border-radius:10px;border:1px solid rgba(255,255,255,.02);cursor:pointer;display:flex;align-items:center;gap:10px}
    .option:hover{transform:translateY(-2px);box-shadow:0 6px 18px rgba(2,6,23,.5)}
    .option input{transform:scale(1.1)}

    .controls{display:flex;justify-content:space-between;align-items:center;margin-top:16px;gap:12px}
    .btn{background:transparent;border:1px solid rgba(255,255,255,.06);padding:10px 14px;border-radius:10px;color:var(--accent);cursor:pointer}
    .btn.primary{background:linear-gradient(90deg,var(--accent),#60a5fa);color:#051025;border:none}
    .small{font-size:13px;color:var(--muted)}

    .result{display:none;flex-direction:column;gap:12px;align-items:center;text-align:center}
    .score{font-size:36px;font-weight:700;color:var(--accent)}
    .breakdown{width:100%;display:grid;grid-template-columns:1fr 1fr;gap:10px}
    .card-mini{background:rgba(255,255,255,.02);padding:10px;border-radius:8px}

    footer{margin-top:12px;color:var(--muted);font-size:13px;text-align:center}

    @media (max-width:620px){.breakdown{grid-template-columns:1fr}.logo{width:52px;height:52px}.q{font-size:16px}}
  </style>
</head>
<body>
  <div class="wrap">
    <header>
      <div class="logo">Qv3</div>
      <div>
        <h1>QuizAppV3 ‚Äî D√©veloppement informatique üöÄ</h1>
        <p class="lead">20 questions ‚Äî Choix multiples ‚Äî Con√ßu pour apprendre vite.</p>
      </div>
    </header>

    <div class="card" id="app">
      <div class="question-meta">
        <div class="small">Question <strong id="qIndex">1</strong>/20</div>
        <div style="display:flex;align-items:center;gap:8px">
          <div class="small">Score: <span id="score">0</span></div>
          <div class="progress" aria-hidden="true"><i id="progressBar"></i></div>
        </div>
      </div>

      <div>
        <div class="q" id="questionText">...chargement</div>
        <div class="options" id="options"></div>
      </div>

      <div class="controls">
        <button class="btn" id="prevBtn">‚¨ÖÔ∏è Pr√©c√©dent</button>
        <div style="display:flex;gap:8px">
          <button class="btn" id="showAnsBtn">Voir r√©ponse</button>
          <button class="btn primary" id="nextBtn">Suivant ‚û°Ô∏è</button>
        </div>
      </div>

      <div class="result" id="resultBox">
        <div class="score" id="finalScore">0 / 20</div>
        <div class="breakdown">
          <div class="card-mini">‚úÖ Corrects: <strong id="correctCount">0</strong></div>
          <div class="card-mini">‚ùå Incorrects: <strong id="wrongCount">0</strong></div>
        </div>
        <div class="small">Explications en bas ‚Äî clique sur une question pour revoir.</div>
        <div style="width:100%;margin-top:8px;text-align:center">
          <button class="btn" id="restartBtn">Refaire le quiz üîÅ</button>
          <button class="btn primary" id="reviewBtn">Revoir les explications</button>
        </div>
      </div>

      <div id="explanations" style="margin-top:14px;display:none"></div>

    </div>

    <footer>Cr√©√© pour toi, Nathan. Bonne chance ! ‚ú®</footer>
  </div>

  <script>
    const quiz = [
      {q: "1) Qu'est-ce que le HTML ?", options: ["Un langage de style", "Un langage de balisage", "Un langage de programmation", "Un framework JavaScript"], answer:1, explain: "HTML = HyperText Markup Language, structure le contenu d'une page web."},
      {q: "2) Quel est le r√¥le du CSS ?", options: ["G√©rer la logique c√¥t√© serveur", "Styliser la pr√©sentation d'une page web", "Stocker des donn√©es", "Optimiser la base de donn√©es"], answer:1, explain: "CSS s'occupe des couleurs, mise en page, typographie..."},
      {q: "3) Lequel n'est pas un type de boucle en JavaScript ?", options: ["for", "while", "loop", "do...while"], answer:2, explain: "Il n'y a pas de boucle native appel√©e 'loop' en JS."},
      {q: "4) Qu'est-ce qu'une fonction pure ?", options: ["Qui utilise le DOM","Qui n'a pas d'effets secondaires et retourne toujours la m√™me sortie pour la m√™me entr√©e","Qui modifie une variable globale","Qui fait des requ√™tes r√©seau"], answer:1, explain: "Les fonctions pures d√©pendent seulement de leurs arguments et ne modifient rien √† l'ext√©rieur."},
      {q: "5) Que signifie O(n) ?", options: ["Complexit√© constante","Complexit√© lin√©aire","Complexit√© quadratique","Complexit√© logarithmique"], answer:1, explain: "O(n) : le temps cro√Æt lin√©airement avec la taille n."},
      {q: "6) Git : quelle commande r√©cup√®re les commits distants sans les fusionner ?", options: ["git pull","git clone","git fetch","git merge"], answer:2, explain: "git fetch t√©l√©charge les donn√©es distantes; git pull fait fetch + merge."},
      {q: "7) REST est :", options: ["Un protocole r√©seau bas-niveau","Un style architectural pour APIs","Un langage de programmation","Une base de donn√©es"], answer:1, explain: "REST d√©finit des conventions pour construire des APIs HTTP."},
      {q: "8) Quel header HTTP est utilis√© pour indiquer le type de contenu ?", options: ["Authorization","Content-Type","Accept-Language","Cache-Control"], answer:1, explain: "Content-Type indique 'application/json', 'text/html', etc."},
      {q: "9) SQL injection : c'est quoi ?", options: ["Un test de performance SQL","Une attaque qui injecte du SQL malveillant","Un pattern de design","Un type d'index"], answer:1, explain: "L'attaque ins√®re du SQL via des entr√©es non-sanitized."},
      {q: "10) Qu'est-ce qu'une closure en JavaScript ?", options: ["Une variable globale","Une fonction qui rappelle une autre fonction","Une fonction qui garde l'acc√®s √† son scope m√™me apr√®s ex√©cution","Un type d'objet"], answer:2, explain: "Une closure capture son environnement lexical."},
      {q: "11) Quelle est la diff√©rence principale entre let et var en JS ?", options: ["let est bloqu√© par le scope de bloc, var non","var est asynchrone","let cr√©e des variables globales","var n'existe pas en ES5"], answer:0, explain: "let respecte le scope de bloc { }, var est function-scoped."},
      {q: "12) Quel est l'int√©r√™t d'un index en base de donn√©es ?", options: ["Augmenter la taille de la DB","Acc√©l√©rer les recherches","Supprimer les lignes dupliqu√©es","Crypter les donn√©es"], answer:1, explain: "Les index acc√©l√®rent les SELECT mais ralentissent parfois INSERT/UPDATE."},
      {q: "13) Quel pattern est utilis√© pour s√©parer interface et impl√©mentation (ex : controller/view) ?", options: ["Singleton","Factory","MVC","Observer"], answer:2, explain: "MVC = Model-View-Controller s√©pare logique / interface / donn√©es."},
      {q: "14) Que fait 'async/await' en JS ?", options: ["Rend une fonction synchrone","Permet d'√©crire du code asynchrone fa√ßon synchrone","Cr√©e des threads","Bloque l'UI"], answer:1, explain: "async/await facilite la lecture du code asynchrone bas√© sur Promises."},
      {q: "15) Test unitaire = ?", options: ["Test global du produit","Test d'une petite unit√© de code (fonction, module)","Test d'int√©gration r√©seau","Test de charge"], answer:1, explain: "Les tests unitaires v√©rifient des fonctions/m√©thodes isol√©es."},
      {q: "16) Qu'est-ce qu'un endpoint API idempotent ?", options: ["Ne modifie jamais rien","Produit le m√™me effet peu importe le nombre de requ√™tes","Est toujours s√©curis√©","Retourne toujours 200"], answer:1, explain: "Idempotent = r√©p√©ter la m√™me demande donne le m√™me r√©sultat d'√©tat."},
      {q: "17) Qu'est-ce que le DOM ?", options: ["Document Object Model","Distributed Object Manager","Data Oriented Module","Dynamic Onload Manager"], answer:0, explain: "DOM repr√©sente la structure HTML en objets manipulables par JS."},
      {q: "18) Quel est l'algorithme de tri moyen le plus utilis√© pour son √©quilibre simplicit√©/perf ?", options: ["Bubble sort","Selection sort","QuickSort","Bogosort"], answer:2, explain: "QuickSort est souvent tr√®s rapide en pratique (pivot choisi correctement)."},
      {q: "19) Que fait CORS ?", options: ["Autorise ou bloque les requ√™tes cross-origin c√¥t√© navigateur","Chiffre les donn√©es","G√®re l'authentification","Compresse les r√©ponses HTTP"], answer:0, explain: "CORS est un m√©canisme de s√©curit√© du navigateur contr√¥lant l'acc√®s cross-origin."},
      {q: "20) Quelle est la meilleure pratique pour stocker des mots de passe ?", options: ["En clair dans la DB","Hash + salt (ex: bcrypt)","Dans un fichier texte","Base64 encoding"], answer:1, explain: "Toujours hasher et saler les mots de passe; ne pas stocker en clair."},
    ];

    // State
    let index = 0;
    let score = 0;
    const answers = Array(quiz.length).fill(null);

    const qIndexEl = document.getElementById('qIndex');
    const questionText = document.getElementById('questionText');
    const optionsEl = document.getElementById('options');
    const scoreEl = document.getElementById('score');
    const progressBar = document.getElementById('progressBar');
    const prevBtn = document.getElementById('prevBtn');
    const nextBtn = document.getElementById('nextBtn');
    const showAnsBtn = document.getElementById('showAnsBtn');
    const resultBox = document.getElementById('resultBox');
    const finalScore = document.getElementById('finalScore');
    const correctCountEl = document.getElementById('correctCount');
    const wrongCountEl = document.getElementById('wrongCount');
    const restartBtn = document.getElementById('restartBtn');
    const reviewBtn = document.getElementById('reviewBtn');
    const explanationsEl = document.getElementById('explanations');

    function render(){
      const cur = quiz[index];
      qIndexEl.textContent = index+1;
      questionText.textContent = cur.q;
      optionsEl.innerHTML = '';
      cur.options.forEach((opt,i)=>{
        const div = document.createElement('label');
        div.className = 'option';
        div.innerHTML = `<input type="radio" name="opt" value="${i}" ${answers[index]===i? 'checked' : ''}/> <span>${opt}</span>`;
        div.onclick = ()=> select(i);
        optionsEl.appendChild(div);
      });

      progressBar.style.width = `${((index)/quiz.length)*100}%`;
      prevBtn.disabled = index===0;
      if(index===quiz.length-1){ nextBtn.textContent = 'Terminer ‚úÖ'; } else { nextBtn.textContent = 'Suivant ‚û°Ô∏è'; }
      updateScoreDisplay();
    }

    function select(i){
      // set answer for current q
      if(answers[index]===null){ // first time selecting
        answers[index]=i;
        if(i===quiz[index].answer){ score++; }
      } else {
        // change answer adjust score
        if(answers[index]===quiz[index].answer) score--; // previously correct
        answers[index]=i;
        if(i===quiz[index].answer) score++;
      }
      updateScoreDisplay();
      // mark selected radio
      const radios = optionsEl.querySelectorAll('input');
      radios.forEach(r=> r.checked = r.value==i);
      // auto-advance a bit
      setTimeout(()=>{
        // do nothing; keep user control
      },120);
    }

    function updateScoreDisplay(){ scoreEl.textContent = score; }

    prevBtn.addEventListener('click',()=>{
      if(index>0){ index--; render(); }
    });

    nextBtn.addEventListener('click',()=>{
      if(index<quiz.length-1){ index++; render(); }
      else finish();
    });

    showAnsBtn.addEventListener('click',()=>{
      const correct = quiz[index].answer;
      const opts = optionsEl.querySelectorAll('.option');
      opts.forEach((el,i)=>{
        el.style.border = '1px solid rgba(255,255,255,.02)';
        el.style.opacity = '0.9';
        if(i===correct){ el.style.border = '2px solid var(--accent)'; }
        if(answers[index]===i){ // user choice
          if(i===correct) el.style.background = 'linear-gradient(90deg, rgba(110,231,183,.08), rgba(96,165,250,.06))';
          else el.style.background = 'linear-gradient(90deg, rgba(255,102,102,.04), rgba(255,102,102,.02))';
        }
      });
    });

    function finish(){
      // show result
      resultBox.style.display = 'flex';
      explanationsEl.style.display = 'none';
      finalScore.textContent = `${score} / ${quiz.length}`;
      const corrects = answers.reduce((acc,a,i)=> acc + (a===quiz[i].answer?1:0),0);
      correctCountEl.textContent = corrects;
      wrongCountEl.textContent = quiz.length - corrects;
      // save highscore
      try{ const hs = localStorage.getItem('QuizAppV3_highscore')||0; if(score>Number(hs)) localStorage.setItem('QuizAppV3_highscore',score); }catch(e){}
      // build explanations
      buildExplanations();
      // scroll to result
      resultBox.scrollIntoView({behavior:'smooth'});
    }

    function buildExplanations(){
      explanationsEl.innerHTML = '';
      quiz.forEach((item,i)=>{
        const wrap = document.createElement('div');
        wrap.className = 'card-mini';
        wrap.style.marginTop = '8px';
        const correct = item.answer;
        const user = answers[i]===null? 'Non r√©pondu' : item.options[answers[i]];
        wrap.innerHTML = `<strong>Q${i+1}:</strong> ${item.q}<br>
          <em>R√©ponse correcte:</em> ${item.options[correct]}<br>
          <em>Ta r√©ponse:</em> ${user}<br>
          <div style="margin-top:6px;color:var(--muted)">${item.explain}</div>`;
        wrap.onclick = ()=>{ index = i; resultBox.style.display='none'; render(); window.scrollTo({top:0,behavior:'smooth'}); };
        explanationsEl.appendChild(wrap);
      });
    }

    restartBtn.addEventListener('click',()=>{
      index=0;score=0;answers.fill(null);resultBox.style.display='none';explanationsEl.style.display='none';render();
    });

    reviewBtn.addEventListener('click',()=>{
      explanationsEl.style.display = 'block';
      explanationsEl.scrollIntoView({behavior:'smooth'});
    });

    // init
    render();

  </script>
</body>
</html>
